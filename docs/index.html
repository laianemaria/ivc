<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Painel Índice de Vulnerabilidade Climática</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
        integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
        crossorigin="anonymous"></script>
    <!-- Load d3.js -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js"
        integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/7d94912b47.js" crossorigin="anonymous"></script>
    <script src="Functions.js"></script>
</head>

<style>
    sup {
        font-size: 0.45em;
        color: #202020;
        vertical-align: super;

    }

    .tooltip {
        position: absolute;
        text-align: center;
        width: auto;
        height: auto;
        padding: 2px;
        font: 12px sans-serif;
        background: lightsteelblue;
        border: 0px;
        border-radius: 8px;
        pointer-events: none;
    }
</style>

<body>
    <main class="container-fluid">
        <!-- Modal -->
<div class="modal fade" id="betaModal" tabindex="-1" role="dialog" aria-labelledby="betaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header bg-dark text-white">
            <h2 class="modal-title">Painel Índice de Vulnerabilidade Climática</h2>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body h1">
            <p>Atenção: Esta página está em fase de testes beta. Problemas podem ocorrer durante a visualização e uso do site.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-lg btn-primary" data-bs-dismiss="modal">Entendi</button>
          </div>
        </div>
      </div>
    
  </div>

        <div class="h1 text-center mt-5 mb-5 display-6"><b>Dashboard<br>Monitoramento das Vulnerabilidades<br>das Zonas
                Costeiras do Pará</b>
            <figcaption class="blockquote-footer mt-2 small">
                Versão beta
            </figcaption>
        </div>

        <div id="optCard" class="card"></div>


        <div class="row row-cols-sm-1 row-cols-md-2 row-cols-xl-3 mt-5">
            <div class="col mt-2 mb-2">

                <div class="card">
                    <div class="card-header bg-dark text-white h3"><b>Zonas Costeiras do Pará</b></div>
                    <div class="card-body">
                        <svg id="ZCP" width="800" height="650"></svg>
                    </div>
                    <div class="card-footer bg-dark text-center">
                        <div class="row row-cols-2">
                            <div class="col">
                                <div id="NomeZCP" class="text-white"></div>
                            </div>
                            <div class="col">
                                <button id="DownFigSetorAll" type="button" class="btn btn-light w-75"><b>Download</b></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col mt-2 mb-2">
                <div class="card">
                    <div class="card-header bg-dark text-white h3"><b>Setor 1 - Marajó Ocidental</b></div>
                    <div class="card-body">
                        <svg id="Setor1" width="800" height="650"></svg>
                    </div>
                    <div class="card-footer bg-dark text-center">
                        <div class="row row-cols-2">
                            <div class="col">
                                <div id="NomeSetor1" class="text-white h4"></div>
                            </div>
                            <div class="col">
                                <!-- <button id="DownFigSetor1" type="button" class="btn btn-light w-75"><b>Download</b></button> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col mt-2 mb-2">
                <div class="card">
                    <div class="card-header bg-dark text-white h3"><b>Setor 2 - Marajó Oriental</b></div>
                    <div class="card-body">
                        <svg id="Setor2" width="800" height="650"></svg>
                    </div>
                    <div class="card-footer bg-dark text-center">
                        <div class="row row-cols-2">
                            <div class="col">
                                <div id="NomeSetor2" class="text-white h4"></div>
                            </div>
                            <div class="col">
                                <!-- <button id="DownFigSetor1" type="button" class="btn btn-light w-75"><b>Download</b></button> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col mt-2 mb-2">
                <div class="card">
                    <div class="card-header bg-dark text-white h3"><b>Setor 3 - Continental Estuarino</b></div>
                    <div class="card-body">
                        <svg id="Setor3" width="800" height="650"></svg>
                    </div>
                    <div class="card-footer bg-dark text-center">
                        <div class="row row-cols-2">
                            <div class="col">
                                <div id="NomeSetor3" class="text-white h4"></div>
                            </div>
                            <div class="col">
                                <!-- <button id="DownFigSetor1" type="button" class="btn btn-light w-75"><b>Download</b></button> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col mt-2 mb-2">
                <div class="card">
                    <div class="card-header bg-dark text-white h3"><b>Setor 4 - Flúvio-Marítimo</b></div>
                    <div class="card-body">
                        <svg id="Setor4" width="800" height="650"></svg>
                    </div>
                    <div class="card-footer bg-dark text-center">
                        <div class="row row-cols-2">
                            <div class="col">
                                <div id="NomeSetor4" class="text-white h4"></div>
                            </div>
                            <div class="col">
                                <!-- <button id="DownFigSetor1" type="button" class="btn btn-light w-75"><b>Download</b></button> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col mt-2 mb-2">
                <div class="card">
                    <div class="card-header bg-dark text-white h3"><b>Setor 5 - Costa Atlântica Paraense</b></div>
                    <div class="card-body">
                        <svg id="Setor5" width="800" height="650"></svg>
                    </div>
                    <div class="card-footer bg-dark text-center">
                        <div class="row row-cols-2">
                            <div class="col">
                                <div id="NomeSetor5" class="text-white h4"></div>
                            </div>
                            <div class="col">
                                <!-- <button id="DownFigSetor1" type="button" class="btn btn-light w-75"><b>Download</b></button> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

    </main>
    <script>
        popularCardComSelects();
        $(document).ready(function () {
            $('#betaModal').modal('show');
            const btnConsultar = document.getElementById('btnConsultar');
            btnConsultar.addEventListener('click', function () {
                const baseDados = document.getElementById('inputDataBase').value;
                const indicador = document.getElementById('inputIndicador').value;
                if (baseDados == 'Instituto Água e Saneamento') {
                    if (indicador == 'Política Municipal de Saneamento Básico') {
                        desenharMapa("#ZCP", "allSectors.geojson", 'data.csv', 'Possui Política Municipal de Saneamento Básico');
                        desenharMapa("#Setor1", "SectorOne.geojson", 'data.csv', 'Possui Política Municipal de Saneamento Básico');
                        desenharMapa("#Setor2", "SectorTwo.geojson", 'data.csv', 'Possui Política Municipal de Saneamento Básico');
                        desenharMapa("#Setor3", "SectorThree.geojson", 'data.csv', 'Possui Política Municipal de Saneamento Básico');
                        desenharMapa("#Setor4", "SectorFour.geojson", 'data.csv', 'Possui Política Municipal de Saneamento Básico');
                        desenharMapa("#Setor5", "SectorFive.geojson", 'data.csv', 'Possui Política Municipal de Saneamento Básico');
                    }
                    else if (indicador == 'Plano Municipal de Saneamento Básico') {
                        desenharMapa("#ZCP", "allSectors.geojson", 'data.csv', 'Possui Plano Municipal de Saneamento Básico');
                        desenharMapa("#Setor1", "SectorOne.geojson", 'data.csv', 'Possui Plano Municipal de Saneamento Básico');
                        desenharMapa("#Setor2", "SectorTwo.geojson", 'data.csv', 'Possui Plano Municipal de Saneamento Básico');
                        desenharMapa("#Setor3", "SectorThree.geojson", 'data.csv', 'Possui Plano Municipal de Saneamento Básico');
                        desenharMapa("#Setor4", "SectorFour.geojson", 'data.csv', 'Possui Plano Municipal de Saneamento Básico');
                        desenharMapa("#Setor5", "SectorFive.geojson", 'data.csv', 'Possui Plano Municipal de Saneamento Básico');
                    }
                    else {
                        desenharMapa("#ZCP", "allSectors.geojson", 'data.csv', indicador);
                        desenharMapa("#Setor1", "SectorOne.geojson", 'data.csv', indicador);
                        desenharMapa("#Setor2", "SectorTwo.geojson", 'data.csv', indicador);
                        desenharMapa("#Setor3", "SectorThree.geojson", 'data.csv', indicador);
                        desenharMapa("#Setor4", "SectorFour.geojson", 'data.csv', indicador);
                        desenharMapa("#Setor5", "SectorFive.geojson", 'data.csv', indicador);
                    }
                }
            });
            function downloadPNG() {
                var svg = document.querySelector('svg'); // Seleciona o elemento SVG que você deseja baixar
                var svgData = new XMLSerializer().serializeToString(svg);
                var canvas = document.createElement('canvas'); // Cria um elemento canvas
                canvas.width = svg.width.baseVal.value; // Define a largura do canvas
                canvas.height = svg.height.baseVal.value; // Define a altura do canvas
                var ctx = canvas.getContext('2d');
                var img = document.createElement('img');
                img.setAttribute('src', 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svgData))));

                img.onload = function () {
                    ctx.drawImage(img, 0, 0);
                    var pngData = canvas.toDataURL('image/png'); // Converte o canvas para formato PNG
                    var downloadLink = document.createElement('a'); // Cria um link para download
                    downloadLink.download = 'mapa.png'; // Define o nome do arquivo para download
                    downloadLink.href = pngData;
                    downloadLink.click(); // Inicia o download
                };
            }

            // Adiciona um ouvinte de evento ao botão com o ID 'DownFigSetor1'
            document.getElementById('DownFigSetorAll').addEventListener('click', downloadPNG);
            //document.getElementById('DownFigSetor1').addEventListener('click', downloadPNG);
            //document.getElementById('DownFigSetor2').addEventListener('click', downloadPNG);
            //document.getElementById('DownFigSetor3').addEventListener('click', downloadPNG);
            //document.getElementById('DownFigSetor4').addEventListener('click', downloadPNG);
            //document.getElementById('DownFigSetor5').addEventListener('click', downloadPNG);

        });

    </script>
    <div class="text-center text-white bg-dark mt-0 py-1">Página criada por Laiane Rodrigues</div>

</body>

</html>